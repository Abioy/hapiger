var Hapi = require('hapi');
var Good = require('./lib');

var server = new Hapi.Server();
server.connection({ host: 'localhost', port: 9001});

var goodOptions = {
    opsInterval: 1000,
    responseEvent: 'tail',
    reporters: [{
        reporter: require('good-file'),
        args: ['./__log.log', {
            response: '*',
            ops: '*',
            error: '*',
            log: '*',
            request: '*'
        }]
    }]
};

server.route({
    method: 'get',
    path: '/',
    handler: function (request, reply) {

        request.log();
        reply();
    }
});

server.on('request', function (request, event, tags) {

    console.log(request);
    console.log(event);
    console.log(tags);
});

server.register({
    register: Good,
    options: goodOptions
}, function (err) {

    if (err) {
        console.error(err);
    }
    else {
        server.start(function () {

            console.info('Server started at ' + server.info.uri);
        });
    }
});